<?xml version = "1.0" ?>
<class name = "Preview Subscribe" module = "PathView">
  Subscribe channel for the PathView Preview channels.

  <socket type = "SUB" nature = "client" name = "socket">
    Alle messages are passed over this socket.

    <incoming name = "*">
      Any message from publiser.
      <event name = "message received" when = "up"/>
    </incoming>
  </socket>

  <trigger name = "start">
    <event name = "connect" when = "down"/>
  </trigger>

  <trigger name = "stop">
    <event name = "disconnect" when = "up"/>
  </trigger>

  <trigger name = "connected">
    <event name = "connected" when = "trying"/>
  </trigger>

  <fsm name = "fsm" initial = "down">
    <state name = "down">
      <event name = "connect" next = "trying">
        <action name = "start socket" />
        <action name = "connected" />
      </event>
    </state>

    <state name = "trying" inherit = "defaults">
      <event name = "connected" next = "up">
      </event>
    </state>

    <state name = "up" inherit = "defaults">
      <event name = "message received" next = "up">
      </event>
    </state>

    <state name = "defaults">
      <event name = "disconnect" next = "down">
        <action name = "stop socket" />
      </event>
    </state>
  </fsm>
</class>
